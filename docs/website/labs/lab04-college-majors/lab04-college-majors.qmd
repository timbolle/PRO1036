---
title: "Lab 04 - Quel grade choisir ?"
---

```{r include = FALSE}
knitr::opts_chunk$set(
  eval = FALSE,
  out.width = "80%",
  fig.asp = 0.618,
  fig.width = 10,
  dpi = 300
)
```

```{r photo, fig.margin = TRUE, echo = FALSE, fig.width = 3, fig.cap = "Photo by Marleena Garris on Unsplash", eval = TRUE}
knitr::include_graphics("figs/graduate.jpg")
```

La premiÃ¨re Ã©tape du processus de transformation de lâ€™information en connaissance est de rÃ©sumer et de dÃ©crire les informations brutes - les donnÃ©es. Dans cet exercice, nous explorons les donnÃ©es sur les grades universitaires et les revenus, en particulier les donnÃ©es derriÃ¨re lâ€™article de FiveThirtyEight [â€œLe guide Ã©conomique pour choisir une majeure universitaireâ€](https://fivethirtyeight.com/features/the-economic-guide-to-picking-a-college-major/).

Les donnÃ©es proviennent initialement de lâ€™American Community Survey (ACS) 2010-2012 Public Use Microdata Series. Bien que cela soit hors du cadre de cet exercice, si vous Ãªtes curieux de savoir comment les donnÃ©es brutes de lâ€™ACS ont Ã©tÃ© nettoyÃ©es et prÃ©parÃ©es, consultez [le code](https://github.com/fivethirtyeight/data/blob/master/college-majors/college-majors-rscript.R) utilisÃ© par les auteurs de FiveThirtyEight.

Nous devons Ã©galement noter quâ€™il y a de nombreux facteurs Ã  prendre en compte pour choisir un grade. Le potentiel de revenus et les perspectives dâ€™emploi en sont deux, et ils sont importants, mais ils ne racontent pas toute lâ€™histoire. Gardez cela Ã  lâ€™esprit en analysant les donnÃ©es.

# Mise en place

Go to the course GitHub organization and locate your homework repo, which should be named `hw-04-college-majors-YOUR_GITHUB_USERNAME`.
Grab the URL of the repo, and clone it in RStudio.
First, open the R Markdown document `lab-04.Rmd` and Knit it.
Make sure it compiles without errors.
The output will be in the file markdown `.md` file with the same name.

Sur le portail de cours, vous trouverez un lien d'invitation pour votre repo sur GitHub Classroom, qui devrait Ãªtre nommÃ© hw-04-college-majors-VOTRE_NOM_UTILISATEUR_GITHUB. Prenez lâ€™URL du dÃ©pÃ´t et clonez-le dans RStudio. Tout dâ€™abord, ouvrez le document R Markdown hw-04.Rmd et Knit-le. Assurez-vous quâ€™il se compile sans erreurs. Le rÃ©sultat sera dans le fichier markdown .md du mÃªme nom.

## Warm up

Avant de prÃ©senter les donnÃ©es, rÃ©chauffons-nous avec quelques exercices simples.
  - Mettez Ã  jour le YAML, en changeant le nom de lâ€™auteur pour votre nom, et **knit** le document.
  - Faites un commit de vos modifications avec un message de commit.
  - Poussez vos modifications sur GitHub.
  - Allez dans votre dÃ©pÃ´t sur GitHub et confirmez que vos modifications sont visibles dans vos fichiers Rmd **et** md. Si quelque chose manque, faites un commit et poussez Ã  nouveau.
  

## Packages

Nous utiliserons le package **tidyverse** pour une grande partie de la manipulation et de la visualisation des donnÃ©es, le package **scales** pour un meilleur formatage des Ã©tiquettes sur les visualisations, et le package **fivethirtyeight** pour les donnÃ©es. Installez-les si ce n'est pas dÃ©jÃ  fait.

```{r load-packages, message = FALSE, eval = TRUE}
library(tidyverse)
library(scales)
library(fivethirtyeight)
```

## DonnÃ©es

Les donnÃ©es se trouvent dans le package **fivethirtyeight**, et le dataframe sâ€™appelle `college_recent_grads`. Comme le jeu de donnÃ©es est distribuÃ© avec le package, nous nâ€™avons pas besoin de le charger sÃ©parÃ©ment ; il devient disponible lorsque nous chargeons le package. Vous pouvez en savoir plus sur le jeu de donnÃ©es en inspectant sa documentation, `?college_recent_grads`. Vous pouvez Ã©galement trouver cette information [ici](https://fivethirtyeight-r.netlify.app/reference/college_recent_grads.html).

Vous pouvez Ã©galement jeter un coup dâ€™Å“il rapide Ã  votre data frame et voir ses dimensions avec la fonction `glimpse`.


```{r glimpse}
glimpse(college_recent_grads)
```

Le data frame `college_recent_grads` est une mine dâ€™informations. RÃ©flÃ©chissons Ã  quelques questions auxquelles nous pourrions vouloir rÃ©pondre avec ces donnÃ©es :

  - Quel grade a le taux de chÃ´mage le plus bas ?
  - Quel grade a le pourcentage de femmes le plus Ã©levÃ© ?
  - Comment les distributions des revenus mÃ©dians se comparent-elles Ã  travers les catÃ©gories de grades ?
  - Les femmes ont-elles tendance Ã  choisir des grades avec des revenus plus bas ou plus Ã©levÃ©s ?

Dans la section suivante, nous visons Ã  rÃ©pondre Ã  ces questions.

# Exercices

## Quel grade a le taux de chÃ´mage le plus bas ?

Pour rÃ©pondre Ã  cette question, tout ce que nous avons Ã  faire est de trier les donnÃ©es. Nous utilisons la fonction `arrange` pour cela, et les trions par la variable `unemployment_rate`. Par dÃ©faut, `arrange` trie par ordre croissant, ce qui est ce que nous voulons ici - nous sommes intÃ©ressÃ©s par le grade avec le taux de chÃ´mage le *plus bas*.


```{r lowest-unemp}
college_recent_grads %>%
  arrange(unemployment_rate)
```

Cela nous donne ce que nous voulions, mais pas sous une forme idÃ©ale. PremiÃ¨rement, le nom du grade tient Ã  peine sur la page. DeuxiÃ¨mement, certaines des variables ne sont pas si utiles (par exemple, `major_code`, `major_category`) et certaines importantes ne sont pas facilement visibles (par exemple, `unemployment_rate`).

Nous pouvons utiliser la fonction `select` pour choisir quelles variables afficher, et dans quel ordre :

```{r lowest-unemp-select}
college_recent_grads %>%
  arrange(unemployment_rate) %>%
  select(rank, major, unemployment_rate)
```

Ok, câ€™est mieux, mais avons-nous vraiment besoin dâ€™afficher toutes ces dÃ©cimales dans la variable de chÃ´mage ? Pas vraiment !

Nous pouvons utiliser la fonction `percent()` pour nettoyer un peu lâ€™affichage.

```{r}
college_recent_grads %>%
  arrange(unemployment_rate) %>%
  select(rank, major, unemployment_rate) %>%
  mutate(unemployment_rate = percent(unemployment_rate))
```

## Quel grade a le pourcentage de femmes le plus Ã©levÃ© ?

### Exercice 1

Pour rÃ©pondre Ã  une telle question, nous devons organiser les donnÃ©es dans lâ€™ordre dÃ©croissant. 

En utilisant ce que vous avez appris jusquâ€™Ã  prÃ©sent, organisez les donnÃ©es dans lâ€™ordre dÃ©croissant par rapport au pourcentage de femmes dans un grade, et affichez uniquement le grade, le nombre total de personnes avec ce grade, et le pourcentage de femmes. Affichez uniquement les trois premiers grades en ajoutant `top_n(3)` Ã  la fin du pipeline.

## Comment les distributions des revenus mÃ©dians se comparent-elles Ã  travers les catÃ©gories de grades ?

### Exercice 2

:::{.callout-note}
Une **percentile** est une mesure utilisÃ©e en statistiques indiquant la valeur en dessous de laquelle un pourcentage donnÃ© dâ€™observations dans un groupe dâ€™observations se situe. Par exemple, le 20e percentile est la valeur en dessous de laquelle 20 % des observations peuvent Ãªtre trouvÃ©es. (Source : [Wikipedia](https://en.wikipedia.org/wiki/Percentile))
:::

Il y a trois types de revenus rapportÃ©s dans ce data frame : `p25th`, `median`, et `p75th`. Ceux-ci correspondent aux 25e, 50e, et 75e percentiles de la distribution des revenus des individus Ã©chantillonnÃ©s pour un grade donnÃ©.

Pourquoi choisissons-nous souvent le mÃ©dian, plutÃ´t que la moyenne, pour dÃ©crire le revenu typique dâ€™un groupe de personnes ?

### Exercice 3

La question Ã  laquelle nous voulons rÃ©pondre est "Comment les distributions des revenus mÃ©dians se comparent-elles Ã  travers les catÃ©gories de grades ?". 

Pour cela, nous devons : dâ€™abord, regrouper les donnÃ©es par `major_category`. Ensuite, trouver un moyen de rÃ©sumer les distributions des revenus mÃ©dians dans ces groupes. Cette dÃ©cision dÃ©pendra des formes de ces distributions. Donc dâ€™abord, nous devons visualiser les donnÃ©es.

Nous utilisons la fonction `ggplot()` pour cela. Le premier argument est le data frame, et lâ€™argument suivant donne la correspondance des variables des donnÃ©es aux Ã©lÃ©ments `aes`thÃ©tiques du graphique.

CommenÃ§ons simplement et regardons la distribution de tous les revenus mÃ©dians, sans considÃ©rer les catÃ©gories majeures. Utilisez la fonction `geom_histogram()` pour faire un premier graphe tout simple des revenus mÃ©dians.


```{r fig,height=2, echo=FALSE}
ggplot(data = college_recent_grads, mapping = aes(x = median)) +
  geom_histogram()
```

En plus du graphique, vous devriez obtenir un message dâ€™avertissement, si vous n'avez pas indiquÃ© une taille de bin :

    `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
    
Cela nous indique que nous pourrions vouloir reconsidÃ©rer la largeur de la classe que nous avons choisie pour notre histogramme - ou plus prÃ©cisÃ©ment, la largeur de la classe que nous nâ€™avons pas spÃ©cifiÃ©e. C'est une bonne pratique de toujours penser dans le contexte des donnÃ©es et d'essayer quelques largeurs de classe. Vous pourriez vous demander : "Quelle serait une diffÃ©rence significative dans les revenus mÃ©dians ?" 1 \$ est Ã©videmment trop peu, 10 000 \$ pourrait Ãªtre trop Ã©levÃ©.

Essayez des largeurs de classe de 1000 \$ et 5000 \$ et choisissez-en une. Expliquez votre choix. Notez que la largeur de la classe est un argument pour la fonction `geom_histogram`.

### Exercice 4

Nous pouvons Ã©galement calculer des statistiques sommaires pour cette distribution en utilisant la fonction `summarise` :

```{r}
college_recent_grads %>%
  summarise(min = min(median), max = max(median),
            mean = mean(median), med = median(median),
            sd = sd(median), 
            q1 = quantile(median, probs = 0.25),
            q3 = quantile(median, probs = 0.75))
```


En vous basant sur la forme de lâ€™histogramme que vous avez crÃ©Ã© dans lâ€™exercice prÃ©cÃ©dent, dÃ©terminez laquelle de ces statistiques sommaires est utile pour dÃ©crire la distribution. RÃ©digez votre description (nâ€™oubliez pas la forme, le centre, la dispersion, les observations inhabituelles) et incluez le rÃ©sultat de la statistique sommaire Ã©galement.

### Exercice 5

Plottez la distribution du revenu mÃ©dian en utilisant un histogramme, facetted par `major_category`. Utilisez la `binwidth` que vous avez choisie dans lâ€™exercice prÃ©cÃ©dent.

### Exercice 6

Maintenant que nous avons vu les formes des distributions des revenus mÃ©dians pour chaque catÃ©gorie majeure, nous devrions avoir une meilleure idÃ©e de la statistique sommaire Ã  utiliser pour quantifier le revenu mÃ©dian typique.


Quelle catÃ©gorie majeure a le revenu mÃ©dian typique le plus Ã©levÃ© ? Constuisez un bloc de code qui groupe selon la `major_category`, summarize en utulisant la statistique retenue et triant dans la bonne direction (nous cherchons la plus Ã©levÃ©e).


```{r eval=FALSE, echo=FALSE}
college_recent_grads %>%
  group_by(major_category) %>%
  summarise(___ = ___(median)) %>%
  arrange(___)
```

### Exercice 7

Quelle catÃ©gorie majeure est la moins populaire dans cet Ã©chantillon ? Vous pouvez vous aider de la foncton `count` pour cela.


```{r echo=FALSE}
college_recent_grads %>%
  count(major_category)
```

ğŸ§¶ âœ… â¬†ï¸ 
*Knit, commit, et push ! Assurez vous de mettre un message Ã  votre commit !*

## Tous les domaines STEM ne sont pas les mÃªmes

Une des sections de lâ€™[article de FiveThirtyEight](https://fivethirtyeight.com/features/the-economic-guide-to-picking-a-college-major/) est "Tous les domaines STEM ne sont pas les mÃªmes". Voyons si câ€™est vrai.

Pour commencer, nous devons dÃ©terminer quelles catÃ©gories majeures sont considÃ©rÃ©es comme des domaines STEM. Une approche serait de crÃ©er un vecteur de catÃ©gories majeures qui sont gÃ©nÃ©ralement considÃ©rÃ©es comme des domaines STEM, puis de crÃ©er une nouvelle variable dans notre data frame qui indique si une majeure est un domaine STEM ou non.

Pour cela, nous devons dâ€™abord crÃ©er un vecteur appelÃ© `stem_categories` qui liste les catÃ©gories majeures qui sont considÃ©rÃ©es comme des domaines STEM.

```{r}
stem_categories <- c("Biology & Life Science",
                     "Computers & Mathematics",
                     "Engineering",
                     "Physical Sciences")
```

Ensuite, nous pouvons utiliser ceci pour crÃ©er une nouvelle variable dans notre data frame indiquant si une majeure est un domaine STEM ou non. Ã€ l'aide la fonction `ifelse` et de l'opÃ©rateur `%in%`, crÃ©ez une nouvelle variable appelÃ©e `major_type` qui est `"stem"` si la `major_category` est dans le vecteur `stem_categories`, et `"not stem"` sinon.


```{r echo=FALSE}
college_recent_grads <- college_recent_grads %>%
  mutate(major_type = ifelse(major_category %in% stem_categories, "stem", "not stem"))
```

### Exercice 8

Nous pouvons utiliser les opÃ©rateurs logiques pour Ã©galement `filter` nos donnÃ©es pour les majeures STEM dont le revenu mÃ©dian est infÃ©rieur au revenu mÃ©dian de toutes les majeures, que nous avons trouvÃ© Ãªtre de 36 000 \$ plus tÃ´t.


```{r echo=FALSE}
college_recent_grads %>%
  filter(
    major_type == "stem",
    median < 36000
  )
```



Quels domaines STEM ont des salaires mÃ©dians Ã©gaux ou infÃ©rieurs au salaire mÃ©dian de toutes les majeures ? Votre sortie ne doit montrer que le nom de la majeure et le revenu mÃ©dian, le 25e percentile, et le 75e percentile pour cette majeure, et doit Ãªtre triÃ©e de telle sorte que la majeure avec le revenu mÃ©dian le plus Ã©levÃ© soit en haut.



ğŸ§¶ âœ… â¬†ï¸ 
*Knit, commit, et push ! Assurez vous de mettre un message Ã  votre commit !*

## Quels types de grades les femmes ont-elles tendance Ã  choisir ?

### Exercice 9

CrÃ©ez un nuage de points du revenu mÃ©dian par rapport Ã  la proportion de femmes dans cette majeure, colorÃ© par le fait que la majeure est un domaine STEM ou non. DÃ©crivez lâ€™association entre ces trois variables.

## Pour aller plus loin

### Exercice 10

Posez une question qui vous intÃ©resse, et rÃ©pondez-y en utilisant des statistiques sommaires et/ou des visualisations.


ğŸ§¶ âœ… â¬†ï¸ 
*Knit, commit, et push ! C'est le dernier commit donc assurez vous que votre rapport soit complet et propre avant de commiter ou pousser !*