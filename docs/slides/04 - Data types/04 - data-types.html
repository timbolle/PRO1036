<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tim Bollé">
<meta name="dcterms.date" content="2024-09-30">

<title>04 - Types de données et transformations – PRO1036</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="../../site_libs/datatables-binding-0.33/datatables.js"></script>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>



<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">PRO1036</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../website/cours/cours.html"> 
<span class="menu-text">Cours</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../website/labs/labs.html"> 
<span class="menu-text">Labs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../website/exercices/exos.html"> 
<span class="menu-text">Exercices</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../website/projet/projet.html"> 
<span class="menu-text">Projet</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#pourquoi-sintéresser-aux-types-de-données" id="toc-pourquoi-sintéresser-aux-types-de-données" class="nav-link active" data-scroll-target="#pourquoi-sintéresser-aux-types-de-données">Pourquoi s’intéresser aux types de données ?</a>
  <ul class="collapse">
  <li><a href="#exemple-cat-lovers" id="toc-exemple-cat-lovers" class="nav-link" data-scroll-target="#exemple-cat-lovers">Exemple: Cat lovers</a></li>
  <li><a href="#statistique-simple" id="toc-statistique-simple" class="nav-link" data-scroll-target="#statistique-simple">Statistique simple…</a></li>
  <li><a href="#pourquoi" id="toc-pourquoi" class="nav-link" data-scroll-target="#pourquoi">Pourquoi ?</a></li>
  <li><a href="#et-maintenant" id="toc-et-maintenant" class="nav-link" data-scroll-target="#et-maintenant">Et maintenant ?</a></li>
  <li><a href="#regardons-les-données" id="toc-regardons-les-données" class="nav-link" data-scroll-target="#regardons-les-données">Regardons les données</a></li>
  <li><a href="#regardons-cela-de-plus-près" id="toc-regardons-cela-de-plus-près" class="nav-link" data-scroll-target="#regardons-cela-de-plus-près">Regardons cela de plus près</a></li>
  <li><a href="#respecter-les-types-de-données" id="toc-respecter-les-types-de-données" class="nav-link" data-scroll-target="#respecter-les-types-de-données">Respecter les types de données</a></li>
  <li><a href="#enregistrer" id="toc-enregistrer" class="nav-link" data-scroll-target="#enregistrer">Enregistrer</a></li>
  <li><a href="#morale" id="toc-morale" class="nav-link" data-scroll-target="#morale">Morale</a></li>
  </ul></li>
  <li><a href="#types-de-données" id="toc-types-de-données" class="nav-link" data-scroll-target="#types-de-données">Types de données</a>
  <ul class="collapse">
  <li><a href="#types-de-données-dans-r" id="toc-types-de-données-dans-r" class="nav-link" data-scroll-target="#types-de-données-dans-r">Types de données dans R</a></li>
  <li><a href="#logical-et-character" id="toc-logical-et-character" class="nav-link" data-scroll-target="#logical-et-character">Logical et character</a></li>
  <li><a href="#double-et-integer" id="toc-double-et-integer" class="nav-link" data-scroll-target="#double-et-integer">Double et integer</a></li>
  <li><a href="#concatenation" id="toc-concatenation" class="nav-link" data-scroll-target="#concatenation">Concatenation</a></li>
  <li><a href="#conversion" id="toc-conversion" class="nav-link" data-scroll-target="#conversion">Conversion</a></li>
  <li><a href="#conversion-1" id="toc-conversion-1" class="nav-link" data-scroll-target="#conversion-1">Conversion</a></li>
  <li><a href="#conversion-2" id="toc-conversion-2" class="nav-link" data-scroll-target="#conversion-2">Conversion</a></li>
  </ul></li>
  <li><a href="#cas-spéciaux" id="toc-cas-spéciaux" class="nav-link" data-scroll-target="#cas-spéciaux">Cas spéciaux</a>
  <ul class="collapse">
  <li><a href="#cas-spéciaux-1" id="toc-cas-spéciaux-1" class="nav-link" data-scroll-target="#cas-spéciaux-1">Cas spéciaux</a></li>
  <li><a href="#na" id="toc-na" class="nav-link" data-scroll-target="#na"><code>NA</code></a></li>
  <li><a href="#na-1" id="toc-na-1" class="nav-link" data-scroll-target="#na-1"><code>NA</code></a></li>
  </ul></li>
  <li><a href="#classes-de-données" id="toc-classes-de-données" class="nav-link" data-scroll-target="#classes-de-données">Classes de données</a>
  <ul class="collapse">
  <li><a href="#classes-de-données-1" id="toc-classes-de-données-1" class="nav-link" data-scroll-target="#classes-de-données-1">Classes de données</a></li>
  <li><a href="#factor" id="toc-factor" class="nav-link" data-scroll-target="#factor"><code>factor</code></a></li>
  <li><a href="#factor-1" id="toc-factor-1" class="nav-link" data-scroll-target="#factor-1"><code>factor</code></a></li>
  <li><a href="#dates" id="toc-dates" class="nav-link" data-scroll-target="#dates">Dates</a></li>
  <li><a href="#dates-1" id="toc-dates-1" class="nav-link" data-scroll-target="#dates-1">Dates</a></li>
  <li><a href="#data-frames" id="toc-data-frames" class="nav-link" data-scroll-target="#data-frames">Data frames</a></li>
  <li><a href="#listes" id="toc-listes" class="nav-link" data-scroll-target="#listes">Listes</a></li>
  <li><a href="#listes-et-data-frames" id="toc-listes-et-data-frames" class="nav-link" data-scroll-target="#listes-et-data-frames">Listes et data frames</a></li>
  </ul></li>
  <li><a href="#travailler-avec-des-facteurs" id="toc-travailler-avec-des-facteurs" class="nav-link" data-scroll-target="#travailler-avec-des-facteurs">Travailler avec des facteurs</a>
  <ul class="collapse">
  <li><a href="#exemple-cat-lovers-1" id="toc-exemple-cat-lovers-1" class="nav-link" data-scroll-target="#exemple-cat-lovers-1">Exemple: Cat lovers</a></li>
  <li><a href="#plotting" id="toc-plotting" class="nav-link" data-scroll-target="#plotting">Plotting</a></li>
  <li><a href="#on-peut-manipuler-les-facteurs-avec-forcats" id="toc-on-peut-manipuler-les-facteurs-avec-forcats" class="nav-link" data-scroll-target="#on-peut-manipuler-les-facteurs-avec-forcats">On peut manipuler les facteurs avec <code>forcats</code></a></li>
  <li><a href="#la-grammaire-de-la-manipulation-de-données" id="toc-la-grammaire-de-la-manipulation-de-données" class="nav-link" data-scroll-target="#la-grammaire-de-la-manipulation-de-données">La grammaire de la manipulation de données</a></li>
  <li><a href="#les-fonctions-de-forcats" id="toc-les-fonctions-de-forcats" class="nav-link" data-scroll-target="#les-fonctions-de-forcats">Les fonctions de <code>forcats</code></a></li>
  <li><a href="#exemple-starwars" id="toc-exemple-starwars" class="nav-link" data-scroll-target="#exemple-starwars">Exemple: starwars</a></li>
  <li><a href="#ordre-selon-la-fréquence-fct_infreq" id="toc-ordre-selon-la-fréquence-fct_infreq" class="nav-link" data-scroll-target="#ordre-selon-la-fréquence-fct_infreq">Ordre selon la fréquence : <code>fct_infreq()</code></a></li>
  <li><a href="#regroupement-de-facteurs" id="toc-regroupement-de-facteurs" class="nav-link" data-scroll-target="#regroupement-de-facteurs">Regroupement de facteurs</a></li>
  <li><a href="#regroupement-de-facteurs-fct_lump" id="toc-regroupement-de-facteurs-fct_lump" class="nav-link" data-scroll-target="#regroupement-de-facteurs-fct_lump">Regroupement de facteurs : <code>fct_lump()</code></a></li>
  <li><a href="#regroupement-de-facteurs-1" id="toc-regroupement-de-facteurs-1" class="nav-link" data-scroll-target="#regroupement-de-facteurs-1">Regroupement de facteurs</a></li>
  <li><a href="#regroupement-et-changement-dordre" id="toc-regroupement-et-changement-dordre" class="nav-link" data-scroll-target="#regroupement-et-changement-dordre">Regroupement et changement d’ordre !</a></li>
  <li><a href="#exemple-hotels" id="toc-exemple-hotels" class="nav-link" data-scroll-target="#exemple-hotels">Exemple: Hotels</a></li>
  <li><a href="#exemple-hotels-1" id="toc-exemple-hotels-1" class="nav-link" data-scroll-target="#exemple-hotels-1">Exemple: Hotels</a></li>
  <li><a href="#choix-manuel-de-lordre-fct_relevel" id="toc-choix-manuel-de-lordre-fct_relevel" class="nav-link" data-scroll-target="#choix-manuel-de-lordre-fct_relevel">Choix manuel de l’ordre : <code>fct_relevel()</code></a></li>
  <li><a href="#renommer-les-niveaux-fct_recode" id="toc-renommer-les-niveaux-fct_recode" class="nav-link" data-scroll-target="#renommer-les-niveaux-fct_recode">Renommer les niveaux : <code>fct_recode()</code></a></li>
  </ul></li>
  <li><a href="#travailler-avec-les-dates" id="toc-travailler-avec-les-dates" class="nav-link" data-scroll-target="#travailler-avec-les-dates">Travailler avec les dates</a>
  <ul class="collapse">
  <li><a href="#dates-2" id="toc-dates-2" class="nav-link" data-scroll-target="#dates-2">Dates</a></li>
  <li><a href="#exemple-des-hotels" id="toc-exemple-des-hotels" class="nav-link" data-scroll-target="#exemple-des-hotels">Exemple des hotels</a></li>
  <li><a href="#étape-1---construire-la-date" id="toc-étape-1---construire-la-date" class="nav-link" data-scroll-target="#étape-1---construire-la-date">Étape 1 - Construire la date</a></li>
  <li><a href="#étape-2---compter-les-réservations-par-dates" id="toc-étape-2---compter-les-réservations-par-dates" class="nav-link" data-scroll-target="#étape-2---compter-les-réservations-par-dates">Étape 2 - Compter les réservations par dates</a></li>
  <li><a href="#étape-4---visualiser" id="toc-étape-4---visualiser" class="nav-link" data-scroll-target="#étape-4---visualiser">Étape 4 - Visualiser</a></li>
  <li><a href="#étape-1---construire-la-date-comme-une-date" id="toc-étape-1---construire-la-date-comme-une-date" class="nav-link" data-scroll-target="#étape-1---construire-la-date-comme-une-date">Étape 1 - Construire la date (comme une date)</a></li>
  <li><a href="#étape-2---compter-les-réservations-par-dates-1" id="toc-étape-2---compter-les-réservations-par-dates-1" class="nav-link" data-scroll-target="#étape-2---compter-les-réservations-par-dates-1">Étape 2 - Compter les réservations par dates</a></li>
  <li><a href="#étape-3a---visualiser" id="toc-étape-3a---visualiser" class="nav-link" data-scroll-target="#étape-3a---visualiser">Étape 3a - Visualiser</a></li>
  <li><a href="#étape-3b---visualiser-avec-une-courbe" id="toc-étape-3b---visualiser-avec-une-courbe" class="nav-link" data-scroll-target="#étape-3b---visualiser-avec-une-courbe">Étape 3b - Visualiser avec une courbe</a></li>
  </ul></li>
  <li><a href="#étude-de-cas-religion-et-revenu" id="toc-étude-de-cas-religion-et-revenu" class="nav-link" data-scroll-target="#étude-de-cas-religion-et-revenu">Étude de cas: Religion et Revenu</a>
  <ul class="collapse">
  <li><a href="#les-données" id="toc-les-données" class="nav-link" data-scroll-target="#les-données">Les données</a></li>
  <li><a href="#les-données-1" id="toc-les-données-1" class="nav-link" data-scroll-target="#les-données-1">Les données</a></li>
  <li><a href="#noms-des-colonnes" id="toc-noms-des-colonnes" class="nav-link" data-scroll-target="#noms-des-colonnes">Noms des colonnes</a></li>
  <li><a href="#tidy" id="toc-tidy" class="nav-link" data-scroll-target="#tidy">Tidy ?</a></li>
  <li><a href="#pivoter-les-données" id="toc-pivoter-les-données" class="nav-link" data-scroll-target="#pivoter-les-données">Pivoter les données</a></li>
  <li><a href="#tidy-1" id="toc-tidy-1" class="nav-link" data-scroll-target="#tidy-1">Tidy !</a></li>
  <li><a href="#calcul-des-fréquences" id="toc-calcul-des-fréquences" class="nav-link" data-scroll-target="#calcul-des-fréquences">Calcul des fréquences</a></li>
  <li><a href="#enregistrer-les-données" id="toc-enregistrer-les-données" class="nav-link" data-scroll-target="#enregistrer-les-données"><span class="heavy-red">Enregistrer</span> les données</a></li>
  <li><a href="#visualisation" id="toc-visualisation" class="nav-link" data-scroll-target="#visualisation">Visualisation</a></li>
  <li><a href="#recodage-des-religions" id="toc-recodage-des-religions" class="nav-link" data-scroll-target="#recodage-des-religions">Recodage des religions</a></li>
  <li><a href="#on-inverse-lordre" id="toc-on-inverse-lordre" class="nav-link" data-scroll-target="#on-inverse-lordre">On inverse l’ordre</a></li>
  <li><a href="#on-nettoie-tout-ça" id="toc-on-nettoie-tout-ça" class="nav-link" data-scroll-target="#on-nettoie-tout-ça">On nettoie tout ça</a></li>
  <li><a href="#tada" id="toc-tada" class="nav-link" data-scroll-target="#tada">TADA ?</a></li>
  <li><a href="#on-veut-les-revenu-dans-le-bon-ordre" id="toc-on-veut-les-revenu-dans-le-bon-ordre" class="nav-link" data-scroll-target="#on-veut-les-revenu-dans-le-bon-ordre">On veut les revenu dans le bon ordre !</a></li>
  <li><a href="#tada-1" id="toc-tada-1" class="nav-link" data-scroll-target="#tada-1">TADA !</a></li>
  <li><a href="#références" id="toc-références" class="nav-link" data-scroll-target="#références">Références</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="04 - data-types.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">04 - Types de données et transformations</h1>
<p class="subtitle lead">PRO1036 - Analyse de données scientifiques en R</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tim Bollé </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 30, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="pourquoi-sintéresser-aux-types-de-données" class="level1">
<h1>Pourquoi s’intéresser aux types de données ?</h1>
<section id="exemple-cat-lovers" class="level2">
<h2 class="anchored" data-anchor-id="exemple-cat-lovers">Exemple: Cat lovers</h2>
<p>Un sondage a demandé à des gens leur nom et le nombre de chat qu’ils possèdent. Les instructions indiquaient d’entrer le nombre de chats en chiffres.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>cat_lovers <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/cat-lovers.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 3
   name           number_of_cats handedness
   &lt;chr&gt;          &lt;chr&gt;          &lt;chr&gt;     
 1 Bernice Warren 0              left      
 2 Woodrow Stone  0              left      
 3 Willie Bass    1              left      
 4 Tyrone Estrada 3              left      
 5 Alex Daniels   3              left      
 6 Jane Bates     2              left      
 7 Latoya Simpson 1              left      
 8 Darin Woods    1              left      
 9 Agnes Cobb     0              left      
10 Tabitha Grant  0              left      
# ℹ 50 more rows</code></pre>
</div>
</div>
</section>
<section id="statistique-simple" class="level2">
<h2 class="anchored" data-anchor-id="statistique-simple">Statistique simple…</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>cat_lovers <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_cats =</span> <span class="fu">mean</span>(number_of_cats))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  mean_cats
      &lt;dbl&gt;
1        NA</code></pre>
</div>
</div>
<p><span class="heavy-red">Ca ne marche pas…</span></p>
</section>
<section id="pourquoi" class="level2">
<h2 class="anchored" data-anchor-id="pourquoi">Pourquoi ?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>?mean</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="figs/mean-help.png" class="img-fluid"></p>
</section>
<section id="et-maintenant" class="level2">
<h2 class="anchored" data-anchor-id="et-maintenant">Et maintenant ?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>cat_lovers <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_cats =</span> <span class="fu">mean</span>(number_of_cats, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  mean_cats
      &lt;dbl&gt;
1        NA</code></pre>
</div>
</div>
<p><span class="heavy-red">Toujours pas…</span></p>
</section>
<section id="regardons-les-données" class="level2">
<h2 class="anchored" data-anchor-id="regardons-les-données">Regardons les données</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(cat_lovers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 60
Columns: 3
$ name           &lt;chr&gt; "Bernice Warren", "Woodrow Stone", "Willie Bass", "Tyro…
$ number_of_cats &lt;chr&gt; "0", "0", "1", "3", "3", "2", "1", "1", "0", "0", "0", …
$ handedness     &lt;chr&gt; "left", "left", "left", "left", "left", "left", "left",…</code></pre>
</div>
</div>
</section>
<section id="regardons-cela-de-plus-près" class="level2">
<h2 class="anchored" data-anchor-id="regardons-cela-de-plus-près">Regardons cela de plus près</h2>
<div class="small">
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-d790ad80846ba163046d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d790ad80846ba163046d">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60"],["Bernice Warren","Woodrow Stone","Willie Bass","Tyrone Estrada","Alex Daniels","Jane Bates","Latoya Simpson","Darin Woods","Agnes Cobb","Tabitha Grant","Perry Cross","Wanda Silva","Alicia Sims","Emily Logan","Woodrow Elliott","Brent Copeland","Pedro Carlson","Patsy Luna","Brett Robbins","Oliver George","Calvin Perry","Lora Gutierrez","Charlotte Sparks","Earl Mack","Leslie Wade","Santiago Barker","Jose Bell","Lynda Smith","Bradford Marshall","Irving Miller","Caroline Simpson","Frances Welch","Melba Jenkins","Veronica Morales","Juanita Cunningham","Maurice Howard","Teri Pierce","Phil Franklin","Jan Zimmerman","Leslie Price","Bessie Patterson","Ethel Wolfe","Naomi Wright","Sadie Frank","Lonnie Cannon","Tony Garcia","Darla Newton","Ginger Clark","Lionel Campbell","Florence Klein","Harriet Leonard","Terrence Harrington","Travis Garner","Doug Bass","Pat Norris","Dawn Young","Shari Alvarez","Tamara Robinson","Megan Morgan","Kara Obrien"],["0","0","1","3","3","2","1","1","0","0","0","0","1","3","3","2","1","1","0","0","1","1","0","0","4","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","3","3","2","1","1.5 - honestly I think one of my cats is half human","0","0","1","0","1","three","1","1","1","0","0","2"],["left","left","left","left","left","left","left","left","left","left","left","left","left","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","right","ambidextrous","ambidextrous","ambidextrous","ambidextrous","ambidextrous"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>name<\/th>\n      <th>number_of_cats<\/th>\n      <th>handedness<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"name","targets":1},{"name":"number_of_cats","targets":2},{"name":"handedness","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</section>
<section id="respecter-les-types-de-données" class="level2">
<h2 class="anchored" data-anchor-id="respecter-les-types-de-données">Respecter les types de données</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>cat_lovers <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">number_of_cats =</span> <span class="fu">case_when</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>      name <span class="sc">==</span> <span class="st">"Ginger Clark"</span> <span class="sc">~</span> <span class="st">"2"</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>      name <span class="sc">==</span> <span class="st">"Doug Bass"</span>    <span class="sc">~</span> <span class="st">"3"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>                   <span class="sc">~</span> number_of_cats</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">number_of_cats =</span> <span class="fu">as.numeric</span>(number_of_cats)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_cats =</span> <span class="fu">mean</span>(number_of_cats))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  mean_cats
      &lt;dbl&gt;
1     0.833</code></pre>
</div>
</div>
</section>
<section id="enregistrer" class="level2">
<h2 class="anchored" data-anchor-id="enregistrer">Enregistrer</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>cat_lovers <span class="ot">&lt;-</span> cat_lovers <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb12-3"><a href="#cb12-3"></a>    <span class="at">number_of_cats =</span> <span class="fu">case_when</span>(</span>
<span id="cb12-4"><a href="#cb12-4"></a>      name <span class="sc">==</span> <span class="st">"Ginger Clark"</span> <span class="sc">~</span> <span class="st">"2"</span>,</span>
<span id="cb12-5"><a href="#cb12-5"></a>      name <span class="sc">==</span> <span class="st">"Doug Bass"</span>    <span class="sc">~</span> <span class="st">"3"</span>,</span>
<span id="cb12-6"><a href="#cb12-6"></a>      <span class="cn">TRUE</span>                   <span class="sc">~</span> number_of_cats</span>
<span id="cb12-7"><a href="#cb12-7"></a>      ),</span>
<span id="cb12-8"><a href="#cb12-8"></a>    <span class="at">number_of_cats =</span> <span class="fu">as.numeric</span>(number_of_cats)</span>
<span id="cb12-9"><a href="#cb12-9"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="morale" class="level2">
<h2 class="anchored" data-anchor-id="morale">Morale</h2>
<ul>
<li>Si vos données ne se comportent pas comme vous l’attendez, il se peut qu’il s’agisse d’un probplème de type de données.</li>
<li>Explorez et investiguez vos données, appliquez les modifications, <em>sauvegardez vos données</em>, vivez heureux</li>
</ul>
</section>
</section>
<section id="types-de-données" class="level1">
<h1>Types de données</h1>
<section id="types-de-données-dans-r" class="level2">
<h2 class="anchored" data-anchor-id="types-de-données-dans-r">Types de données dans R</h2>
<ul>
<li><span class="heavy-red">logical</span></li>
<li><span class="heavy-red">double</span></li>
<li><span class="heavy-red">integer</span></li>
<li><span class="heavy-red">character</span></li>
<li>Il y a en d’autres mais nous les utiliserons peu</li>
</ul>
</section>
<section id="logical-et-character" class="level2">
<h2 class="anchored" data-anchor-id="logical-et-character">Logical et character</h2>
<p><span class="heavy-red">logical</span> - Valeurs booléennes <span class="gray-mono">TRUE</span> et <span class="gray-mono">FALSE</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "logical"</code></pre>
</div>
</div>
<p><br></p>
<p><span class="heavy-red">character</span> - Texte</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="st">"Hello"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
</section>
<section id="double-et-integer" class="level2">
<h2 class="anchored" data-anchor-id="double-et-integer">Double et integer</h2>
<p><span class="heavy-red">double</span> - Nombres à virgule flottante (type par défaut pour les nombres)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
</div>
<p><br></p>
<p><span class="heavy-red">integer</span> - Nombres entiers (indiqué par un <span class="gray-mono">L</span>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="dv">1</span>L)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
</div>
</section>
<section id="concatenation" class="level2">
<h2 class="anchored" data-anchor-id="concatenation">Concatenation</h2>
<p>Des vecteurs peuvent être construits à l’aide de la fonction <span class="gray-mono">c()</span></p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"Hello"</span>, <span class="st">"World!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Hello"  "World!"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">c</span>(<span class="st">"hi"</span>, <span class="st">"hello"</span>), <span class="fu">c</span>(<span class="st">"bye"</span>, <span class="st">"jello"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "hi"    "hello" "bye"   "jello"</code></pre>
</div>
</div>
</section>
<section id="conversion" class="level2">
<h2 class="anchored" data-anchor-id="conversion">Conversion</h2>
<p>… intentionnelle</p>
<div class="columns">
<div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.character</span>(x)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1" "2" "3"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="columns">
<div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "logical"</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(x)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="conversion-1" class="level2">
<h2 class="anchored" data-anchor-id="conversion-1">Conversion</h2>
<p>… accidentelle</p>
<p>R va faire les conversions sans se poser de questions, surtout quand on mets différentes choses dans un même vecteur.</p>
<div class="columns">
<div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="st">"Hello"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1"     "Hello"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="cn">FALSE</span>, <span class="dv">3</span>L)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 3</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fl">1.2</span>, <span class="dv">3</span>L)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.2 3.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">2</span>L, <span class="st">"two"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2"   "two"</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="conversion-2" class="level2">
<h2 class="anchored" data-anchor-id="conversion-2">Conversion</h2>
<ul>
<li><span class="heavy-red">Explicite</span> - Utilisez les fonctions <span class="gray-mono">as.*()</span>
<ul>
<li><span class="gray-mono">as.logical()</span></li>
<li><span class="gray-mono">as.numeric()</span></li>
<li><span class="gray-mono">as.integer()</span></li>
<li><span class="gray-mono">as.character()</span></li>
<li><span class="gray-mono">as.double()</span></li>
</ul></li>
<li><span class="heavy-red">Implicite</span> - R va faire les conversions pour vous, soyez vigilant</li>
</ul>
</section>
</section>
<section id="cas-spéciaux" class="level1">
<h1>Cas spéciaux</h1>
<section id="cas-spéciaux-1" class="level2">
<h2 class="anchored" data-anchor-id="cas-spéciaux-1">Cas spéciaux</h2>
<ul>
<li><span class="gray-mono">NA</span> - Valeur manquante</li>
<li><span class="gray-mono">Inf</span> - Infini</li>
<li><span class="gray-mono">NaN</span> - Not a Number</li>
</ul>
<p><br></p>
<div class="columns">
<div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># division par zéro -&gt; Inf</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span><span class="sc">/</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Inf</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -Inf</code></pre>
</div>
</div>
</div>
</div>
<p><br></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="cn">Inf</span> <span class="sc">-</span> <span class="cn">Inf</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NaN</code></pre>
</div>
</div>
</div>
</section>
<section id="na" class="level2">
<h2 class="anchored" data-anchor-id="na"><code>NA</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   1.00    1.75    2.50    2.50    3.25    4.00       1 </code></pre>
</div>
</div>
</section>
<section id="na-1" class="level2">
<h2 class="anchored" data-anchor-id="na-1"><code>NA</code></h2>
<p>Les <code>NA</code> sont utilisés par R pour représenter des valeurs manquantes. Ils sont de type logique.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "logical"</code></pre>
</div>
</div>
<p><br></p>
<div class="columns">
<div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># TRUE or NA</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">|</span> <span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FALSE or NA</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="cn">FALSE</span> <span class="sc">|</span> <span class="cn">NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="classes-de-données" class="level1">
<h1>Classes de données</h1>
<section id="classes-de-données-1" class="level2">
<h2 class="anchored" data-anchor-id="classes-de-données-1">Classes de données</h2>
<p>Nous avons parlé des <em>types</em> des données et nous allons maintenant parler des <em>classes</em> des données:</p>
<ul>
<li>Vecteurs sont comme des briques LEGO</li>
<li>On les colle ensemble pour construire des structures plus compliquées, notamment des <em>représentations de données</em></li>
</ul>
<p>Par exemples:</p>
<ul>
<li><span class="heavy-red">factor</span></li>
<li><span class="heavy-red">date</span></li>
<li><span class="heavy-red">data frame</span></li>
</ul>
</section>
<section id="factor" class="level2">
<h2 class="anchored" data-anchor-id="factor"><code>factor</code></h2>
<p>Les facteurs sont utilisés pour gérer les variables catégorielles, c’est-à-dire les variables qui ont un ensemble fixe et connu de valeurs possibles.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"BS"</span>, <span class="st">"MS"</span>, <span class="st">"PhD"</span>, <span class="st">"MS"</span>))</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] BS  MS  PhD MS 
Levels: BS MS PhD</code></pre>
</div>
</div>
<p><br></p>
<div class="columns">
<div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="factor-1" class="level2">
<h2 class="anchored" data-anchor-id="factor-1"><code>factor</code></h2>
<p>Pour chaque facteur on a:</p>
<ul>
<li><span class="gray-mono">levels</span> - Les valeurs possibles</li>
<li><span class="gray-mono">labels</span> - Les étiquettes associées aux valeurs</li>
</ul>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 3 levels "BS","MS","PhD": 1 2 3 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.integer</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 2</code></pre>
</div>
</div>
</section>
<section id="dates" class="level2">
<h2 class="anchored" data-anchor-id="dates">Dates</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2024-01-01"</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2024-01-01"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "double"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Date"</code></pre>
</div>
</div>
</section>
<section id="dates-1" class="level2">
<h2 class="anchored" data-anchor-id="dates-1">Dates</h2>
<p>Les dates sont en réalité un entier (le nombre de jours depuis l’origine, 1 Jan 1970) et un entier (l’origine) collés ensemble</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.integer</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19723</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.integer</span>(y) <span class="sc">/</span> <span class="dv">365</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 54.03562</code></pre>
</div>
</div>
</section>
<section id="data-frames" class="level2">
<h2 class="anchored" data-anchor-id="data-frames">Data frames</h2>
<p>Les data frames sont des structures de données qui sont comme des vecteurs de différentes classes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">y =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  x y
1 1 3
2 2 4</code></pre>
</div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="listes" class="level2">
<h2 class="anchored" data-anchor-id="listes">Listes</h2>
<p>Les listes sont des conteneurs génériques pour des vecteurs de n’importe quel type.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="st">"hi"</span>, <span class="st">"hello"</span>, <span class="st">"jello"</span>),</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>l</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$x
[1] 1 2 3 4

$y
[1] "hi"    "hello" "jello"

$z
[1]  TRUE FALSE</code></pre>
</div>
</div>
</section>
<section id="listes-et-data-frames" class="level2">
<h2 class="anchored" data-anchor-id="listes-et-data-frames">Listes et data frames</h2>
<ul>
<li>Un data frame est une liste spéciale contenant des vecteurs de longueur égale</li>
<li>Lorsque nous utilisons la fonction <code>pull()</code>, nous extrayons un vecteur du data frame</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  x y
1 1 3
2 2 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 4</code></pre>
</div>
</div>
</section>
</section>
<section id="travailler-avec-des-facteurs" class="level1">
<h1>Travailler avec des facteurs</h1>
<section id="exemple-cat-lovers-1" class="level2">
<h2 class="anchored" data-anchor-id="exemple-cat-lovers-1">Exemple: Cat lovers</h2>
<p>Nous commençons avec un data frame avec des caractères</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(cat_lovers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 60
Columns: 3
$ name           &lt;chr&gt; "Bernice Warren", "Woodrow Stone", "Willie Bass", "Tyro…
$ number_of_cats &lt;chr&gt; "0", "0", "1", "3", "3", "2", "1", "1", "0", "0", "0", …
$ handedness     &lt;chr&gt; "left", "left", "left", "left", "left", "left", "left",…</code></pre>
</div>
</div>
</section>
<section id="plotting" class="level2">
<h2 class="anchored" data-anchor-id="plotting">Plotting</h2>
<p>Au moment de faire un graphique, R va faire une conversion de type</p>
<p>Si on lui demande de plotter des catégories, il va créer des facteurs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cat_lovers, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> handedness)) <span class="sc">+</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04---data-types_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Les facteurs sont ordonnées par ordre alphabétique par défaut</p>
</section>
<section id="on-peut-manipuler-les-facteurs-avec-forcats" class="level2">
<h2 class="anchored" data-anchor-id="on-peut-manipuler-les-facteurs-avec-forcats">On peut manipuler les facteurs avec <code>forcats</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a>cat_lovers <span class="sc">%&gt;%</span></span>
<span id="cb109-2"><a href="#cb109-2"></a>  <span class="fu">mutate</span>(<span class="at">handedness =</span> <span class="fu">fct_infreq</span>(handedness)) <span class="sc">%&gt;%</span></span>
<span id="cb109-3"><a href="#cb109-3"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> handedness)) <span class="sc">+</span></span>
<span id="cb109-4"><a href="#cb109-4"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04---data-types_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" style="width:55.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="la-grammaire-de-la-manipulation-de-données" class="level2">
<h2 class="anchored" data-anchor-id="la-grammaire-de-la-manipulation-de-données">La grammaire de la manipulation de données</h2>
<p>Basé sur des fonctions qui correspondent à des verbes permettant de manipuler des dataframes.</p>
<div class="columns">
<div class="column" style="width:35%;">
<p><img src="figs/forcats-part-of-tidyverse.png" style="height:60.0%"></p>
</div><div class="column" style="width:65%;">
<ul>
<li>Les facteurs sont utiles lorsque vous avez des données catégorielles et que vous voulez remplacer l’ordre des vecteurs de caractères pour améliorer l’affichage</li>
<li>Le package <strong>forcats</strong> fournit une suite d’outils utiles qui résolvent des problèmes courants avec les facteurs</li>
</ul>
</div>
</div>
</section>
<section id="les-fonctions-de-forcats" class="level2">
<h2 class="anchored" data-anchor-id="les-fonctions-de-forcats">Les fonctions de <code>forcats</code></h2>
<p><code>focats</code> possède plusieurs fonctions pour manipuler les facteurs:</p>
<ul>
<li><span class="gray-mono">fct_reorder()</span> - Réordonne les niveaux d’un facteur en fonction d’une autre variable</li>
<li><span class="gray-mono">fct_relevel()</span> - Réordonne les niveaux d’un facteur</li>
<li><span class="gray-mono">fct_infreq()</span> - Réordonne les niveaux d’un facteur en fonction de leur fréquence</li>
<li><span class="gray-mono">fct_lump()</span> - Regroupe les niveaux d’un facteur en “autres”</li>
<li><span class="gray-mono">fct_explicit_na()</span> - Ajoute un niveau pour les valeurs manquantes</li>
</ul>
</section>
<section id="exemple-starwars" class="level2">
<h2 class="anchored" data-anchor-id="exemple-starwars">Exemple: starwars</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> hair_color)) <span class="sc">+</span> </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04---data-types_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ordre-selon-la-fréquence-fct_infreq" class="level2">
<h2 class="anchored" data-anchor-id="ordre-selon-la-fréquence-fct_infreq">Ordre selon la fréquence : <code>fct_infreq()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fct_infreq</span>(hair_color))) <span class="sc">+</span> </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04---data-types_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regroupement-de-facteurs" class="level2">
<h2 class="anchored" data-anchor-id="regroupement-de-facteurs">Regroupement de facteurs</h2>
<p>Utile quand on a beaucoup de niveaux</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(skin_color, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 2
   skin_color     n
   &lt;chr&gt;      &lt;int&gt;
 1 fair          17
 2 light         11
 3 dark           6
 4 green          6
 5 grey           6
 6 pale           5
 7 brown          4
 8 blue           2
 9 blue, grey     2
10 none           2
# ℹ 21 more rows</code></pre>
</div>
</div>
<p>… 31 niveaux dans cet exemple !</p>
</section>
<section id="regroupement-de-facteurs-fct_lump" class="level2">
<h2 class="anchored" data-anchor-id="regroupement-de-facteurs-fct_lump">Regroupement de facteurs : <code>fct_lump()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">skin_color =</span> <span class="fu">fct_lump</span>(skin_color, <span class="at">n =</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(skin_color, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  skin_color     n
  &lt;fct&gt;      &lt;int&gt;
1 Other         41
2 fair          17
3 light         11
4 dark           6
5 green          6
6 grey           6</code></pre>
</div>
</div>
</section>
<section id="regroupement-de-facteurs-1" class="level2">
<h2 class="anchored" data-anchor-id="regroupement-de-facteurs-1">Regroupement de facteurs</h2>
<p>Regardons maintenant la masse moyenne selon la couleur des yeux:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eye_color =</span> <span class="fu">fct_lump</span>(eye_color, <span class="at">n =</span> <span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(eye_color) <span class="sc">%&gt;%</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_mass =</span> <span class="fu">mean</span>(mass, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> eye_color, <span class="at">y =</span> mean_mass)) <span class="sc">+</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04---data-types_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="regroupement-et-changement-dordre" class="level2">
<h2 class="anchored" data-anchor-id="regroupement-et-changement-dordre">Regroupement et changement d’ordre !</h2>
<p>Nous allons maintenant regrouper les couleurs des yeux et les ordonner selon la masse moyenne</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a>starwars <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="#cb117-2"></a>  <span class="fu">mutate</span>(<span class="at">eye_color =</span> <span class="fu">fct_lump</span>(eye_color, <span class="at">n =</span> <span class="dv">6</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb117-3"><a href="#cb117-3"></a>  <span class="fu">group_by</span>(eye_color) <span class="sc">%&gt;%</span></span>
<span id="cb117-4"><a href="#cb117-4"></a>  <span class="fu">summarise</span>(<span class="at">mean_mass =</span> <span class="fu">mean</span>(mass, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb117-5"><a href="#cb117-5"></a>  <span class="fu">mutate</span>(<span class="at">eye_color =</span> <span class="fu">fct_reorder</span>(eye_color, mean_mass)) <span class="sc">%&gt;%</span></span>
<span id="cb117-6"><a href="#cb117-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> eye_color, <span class="at">y =</span> mean_mass)) <span class="sc">+</span></span>
<span id="cb117-7"><a href="#cb117-7"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04---data-types_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exemple-hotels" class="level2">
<h2 class="anchored" data-anchor-id="exemple-hotels">Exemple: Hotels</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04---data-types_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="exemple-hotels-1" class="level2">
<h2 class="anchored" data-anchor-id="exemple-hotels-1">Exemple: Hotels</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04---data-types_files/figure-html/arrival-month-1.png" class="img-fluid figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="choix-manuel-de-lordre-fct_relevel" class="level2">
<h2 class="anchored" data-anchor-id="choix-manuel-de-lordre-fct_relevel">Choix manuel de l’ordre : <code>fct_relevel()</code></h2>
<p>La variable <code>month.name</code> est une variable intégrée dans R qui contient les noms des mois en anglais et dans le bon ordre.</p>
<div class="long-sourcecode">
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>hotels <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"data/hotels.csv"</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>hotels <span class="sc">%&gt;%</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">arrival_date_month =</span> <span class="fu">fct_relevel</span>(arrival_date_month, month.name)) <span class="sc">%&gt;%</span> <span class="co"># On réordonne les mois</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hotel, arrival_date_month) <span class="sc">%&gt;%</span>   <span class="co"># group by type d'hotel et mois d'arrivée</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_adr =</span> <span class="fu">mean</span>(adr)) <span class="sc">%&gt;%</span>       <span class="co"># calcul de l'ADR moyen pour chaque groupe</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> arrival_date_month,</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> mean_adr,                           <span class="co"># mean_adr sur y-axis</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> hotel,                          <span class="co"># Groupe les lignes par type</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> hotel)                          <span class="co"># couleur par type</span></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span>                             <span class="co"># On veut des lignes</span></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>                         <span class="co"># Utilise le minimal theme</span></span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Arrival month"</span>,                 <span class="co"># On met à jour les labels</span></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mean ADR (average daily rate)"</span>,</span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Comparison of resort and city hotel prices across months"</span>,</span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Resort hotel prices soar in the summer while city hotel prices remain</span><span class="sc">\n</span><span class="st">relatively constant throughout the year"</span>,</span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Hotel type"</span>) <span class="sc">+</span></span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">guide =</span> <span class="fu">guide_axis</span>(<span class="at">check.overlap =</span> <span class="cn">TRUE</span>)) <span class="co"># On s'assure que les labels ne se chevauchent pas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="renommer-les-niveaux-fct_recode" class="level2">
<h2 class="anchored" data-anchor-id="renommer-les-niveaux-fct_recode">Renommer les niveaux : <code>fct_recode()</code></h2>
<p>Si on veut simplement renommer les niveaux, on peut utiliser <code>fct_recode()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>cat_lovers <span class="sc">%&gt;%</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">handedness =</span> <span class="fu">fct_recode</span>(handedness, <span class="at">gaucher =</span> <span class="st">"left"</span>, <span class="at">droitier =</span> <span class="st">"right"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">handedness =</span> <span class="fu">fct_infreq</span>(handedness)) <span class="sc">%&gt;%</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> handedness)) <span class="sc">+</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04---data-types_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="travailler-avec-les-dates" class="level1">
<h1>Travailler avec les dates</h1>
<section id="dates-2" class="level2">
<h2 class="anchored" data-anchor-id="dates-2">Dates</h2>
<div class="columns">
<div class="column" style="width:35%;">
<p><img src="figs/lubridate-not-part-of-tidyverse.png" style="height:60.0%"></p>
</div><div class="column" style="width:65%;">
<ul>
<li><p><strong>lubridate</strong> est un package tidyverse-friendly qui facilite la manipulation des dates</p></li>
<li><p>Il ne fait pas partie du coeur tidyverse, donc il doit être installé avec <code>install.packages("tidyverse)</code> mais il n’est pas chargé avec lui, et doit être explicitement chargé avec <code>library(lubridate)</code>.</p>
<ul>
<li>…</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="exemple-des-hotels" class="level2">
<h2 class="anchored" data-anchor-id="exemple-des-hotels">Exemple des hotels</h2>
<p>Nous allons voir les bases mais travailler avec des dates peut s’avérer complexe mais cela peut apporter beaucoup à une analyse.</p>
<p><span class="question">Calculer et visualiser le nombre de réservations à une date d’arrivée donnée</span></p>
</section>
<section id="étape-1---construire-la-date" class="level2">
<h2 class="anchored" data-anchor-id="étape-1---construire-la-date">Étape 1 - Construire la date</h2>
<div class="cell" data-output.lines="7">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue) <span class="co"># glue permet de coller des éléments ensemble</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>hotels <span class="sc">%&gt;%</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrival_date =</span> <span class="fu">glue</span>(<span class="st">"{arrival_date_year} {arrival_date_month} {arrival_date_day_of_month}"</span>)</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(arrival_date) <span class="co"># pour afficher la nouvelle colonne à gauche</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 119,390 × 33
   arrival_date hotel is_canceled lead_time arrival_date_year arrival_date_month
   &lt;glue&gt;       &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;             &lt;dbl&gt; &lt;chr&gt;             
 1 2015 July 1  Reso…           0       342              2015 July              
 2 2015 July 1  Reso…           0       737              2015 July              
 3 2015 July 1  Reso…           0         7              2015 July              
 4 2015 July 1  Reso…           0        13              2015 July              
 5 2015 July 1  Reso…           0        14              2015 July              
 6 2015 July 1  Reso…           0        14              2015 July              
 7 2015 July 1  Reso…           0         0              2015 July              
 8 2015 July 1  Reso…           0         9              2015 July              
 9 2015 July 1  Reso…           1        85              2015 July              
10 2015 July 1  Reso…           1        75              2015 July              
# ℹ 119,380 more rows
# ℹ 27 more variables: arrival_date_week_number &lt;dbl&gt;,
#   arrival_date_day_of_month &lt;dbl&gt;, stays_in_weekend_nights &lt;dbl&gt;,
#   stays_in_week_nights &lt;dbl&gt;, adults &lt;dbl&gt;, children &lt;dbl&gt;, babies &lt;dbl&gt;,
#   meal &lt;chr&gt;, country &lt;chr&gt;, market_segment &lt;chr&gt;,
#   distribution_channel &lt;chr&gt;, is_repeated_guest &lt;dbl&gt;,
#   previous_cancellations &lt;dbl&gt;, previous_bookings_not_canceled &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="étape-2---compter-les-réservations-par-dates" class="level2">
<h2 class="anchored" data-anchor-id="étape-2---compter-les-réservations-par-dates">Étape 2 - Compter les réservations par dates</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>hotels <span class="sc">%&gt;%</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">arrival_date =</span> <span class="fu">glue</span>(<span class="st">"{arrival_date_year} {arrival_date_month} {arrival_date_day_of_month}"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(arrival_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 793 × 2
   arrival_date       n
   &lt;glue&gt;         &lt;int&gt;
 1 2015 August 1    110
 2 2015 August 10   207
 3 2015 August 11   117
 4 2015 August 12   133
 5 2015 August 13   107
 6 2015 August 14   329
 7 2015 August 15   190
 8 2015 August 16    98
 9 2015 August 17   188
10 2015 August 18    94
# ℹ 783 more rows</code></pre>
</div>
</div>
</section>
<section id="étape-4---visualiser" class="level2">
<h2 class="anchored" data-anchor-id="étape-4---visualiser">Étape 4 - Visualiser</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>hotels <span class="sc">%&gt;%</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">arrival_date =</span> <span class="fu">glue</span>(<span class="st">"{arrival_date_year} {arrival_date_month} {arrival_date_day_of_month}"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(arrival_date) <span class="sc">%&gt;%</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> arrival_date, <span class="at">y =</span> n, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04---data-types_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><span class="question">Quel est le problème ici ?</span></p>
</section>
<section id="étape-1---construire-la-date-comme-une-date" class="level2">
<h2 class="anchored" data-anchor-id="étape-1---construire-la-date-comme-une-date">Étape 1 - Construire la date (comme une date)</h2>
<div class="cell" data-output.lines="7">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># pour les dates</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>hotels <span class="sc">%&gt;%</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrival_date =</span> <span class="fu">ymd</span>(<span class="fu">glue</span>(<span class="st">"{arrival_date_year} {arrival_date_month} {arrival_date_day_of_month}"</span>))</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(arrival_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 119,390 × 33
   arrival_date hotel is_canceled lead_time arrival_date_year arrival_date_month
   &lt;date&gt;       &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;             &lt;dbl&gt; &lt;chr&gt;             
 1 2015-07-01   Reso…           0       342              2015 July              
 2 2015-07-01   Reso…           0       737              2015 July              
 3 2015-07-01   Reso…           0         7              2015 July              
 4 2015-07-01   Reso…           0        13              2015 July              
 5 2015-07-01   Reso…           0        14              2015 July              
 6 2015-07-01   Reso…           0        14              2015 July              
 7 2015-07-01   Reso…           0         0              2015 July              
 8 2015-07-01   Reso…           0         9              2015 July              
 9 2015-07-01   Reso…           1        85              2015 July              
10 2015-07-01   Reso…           1        75              2015 July              
# ℹ 119,380 more rows
# ℹ 27 more variables: arrival_date_week_number &lt;dbl&gt;,
#   arrival_date_day_of_month &lt;dbl&gt;, stays_in_weekend_nights &lt;dbl&gt;,
#   stays_in_week_nights &lt;dbl&gt;, adults &lt;dbl&gt;, children &lt;dbl&gt;, babies &lt;dbl&gt;,
#   meal &lt;chr&gt;, country &lt;chr&gt;, market_segment &lt;chr&gt;,
#   distribution_channel &lt;chr&gt;, is_repeated_guest &lt;dbl&gt;,
#   previous_cancellations &lt;dbl&gt;, previous_bookings_not_canceled &lt;dbl&gt;, …</code></pre>
</div>
</div>
</section>
<section id="étape-2---compter-les-réservations-par-dates-1" class="level2">
<h2 class="anchored" data-anchor-id="étape-2---compter-les-réservations-par-dates-1">Étape 2 - Compter les réservations par dates</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>hotels <span class="sc">%&gt;%</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">arrival_date =</span> <span class="fu">ymd</span>(<span class="fu">glue</span>(<span class="st">"{arrival_date_year} {arrival_date_month} {arrival_date_day_of_month}"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(arrival_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 793 × 2
   arrival_date     n
   &lt;date&gt;       &lt;int&gt;
 1 2015-07-01     122
 2 2015-07-02      93
 3 2015-07-03      56
 4 2015-07-04      88
 5 2015-07-05      53
 6 2015-07-06      75
 7 2015-07-07      54
 8 2015-07-08      69
 9 2015-07-09      80
10 2015-07-10      51
# ℹ 783 more rows</code></pre>
</div>
</div>
</section>
<section id="étape-3a---visualiser" class="level2">
<h2 class="anchored" data-anchor-id="étape-3a---visualiser">Étape 3a - Visualiser</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>hotels <span class="sc">%&gt;%</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">arrival_date =</span> <span class="fu">ymd</span>(<span class="fu">glue</span>(<span class="st">"{arrival_date_year} {arrival_date_month} {arrival_date_day_of_month}"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(arrival_date) <span class="sc">%&gt;%</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> arrival_date, <span class="at">y =</span> n, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04---data-types_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="étape-3b---visualiser-avec-une-courbe" class="level2">
<h2 class="anchored" data-anchor-id="étape-3b---visualiser-avec-une-courbe">Étape 3b - Visualiser avec une courbe</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>hotels <span class="sc">%&gt;%</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">arrival_date =</span> <span class="fu">ymd</span>(<span class="fu">glue</span>(<span class="st">"{arrival_date_year} {arrival_date_month} {arrival_date_day_of_month}"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(arrival_date) <span class="sc">%&gt;%</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> arrival_date, <span class="at">y =</span> n, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>() <span class="co">#&lt;&lt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04---data-types_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="étude-de-cas-religion-et-revenu" class="level1">
<h1>Étude de cas: Religion et Revenu</h1>
<section id="les-données" class="level2">
<h2 class="anchored" data-anchor-id="les-données">Les données</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/religion-income.png" class="img-fluid figure-img"></p>
<figcaption>Source: <a href="https://www.pewforum.org/religious-landscape-study/income-distribution/">Religious Landscape Study</a></figcaption>
</figure>
</div>
</section>
<section id="les-données-1" class="level2">
<h2 class="anchored" data-anchor-id="les-données-1">Les données</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 12
Columns: 6
$ `Religious tradition` &lt;chr&gt; "Buddhist", "Catholic", "Evangelical Protestant"…
$ `Less than $30,000`   &lt;dbl&gt; 0.36, 0.36, 0.35, 0.17, 0.53, 0.48, 0.16, 0.29, …
$ `$30,000-$49,999`     &lt;dbl&gt; 0.18, 0.19, 0.22, 0.13, 0.22, 0.25, 0.15, 0.20, …
$ `$50,000-$99,999`     &lt;dbl&gt; 0.32, 0.26, 0.28, 0.34, 0.17, 0.22, 0.24, 0.28, …
$ `$100,000 or more`    &lt;dbl&gt; 0.13, 0.19, 0.14, 0.36, 0.08, 0.04, 0.44, 0.23, …
$ `Sample Size`         &lt;dbl&gt; 233, 6137, 7462, 172, 1704, 208, 708, 5208, 594,…</code></pre>
</div>
</div>
</section>
<section id="noms-des-colonnes" class="level2">
<h2 class="anchored" data-anchor-id="noms-des-colonnes">Noms des colonnes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>rel_inc <span class="sc">%&gt;%</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>( </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">religion =</span> <span class="st">`</span><span class="at">Religious tradition</span><span class="st">`</span>, </span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="st">`</span><span class="at">Sample Size</span><span class="st">`</span> </span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 6
   religion              `Less than $30,000` `$30,000-$49,999` `$50,000-$99,999`
   &lt;chr&gt;                               &lt;dbl&gt;             &lt;dbl&gt;             &lt;dbl&gt;
 1 "Buddhist"                           0.36              0.18              0.32
 2 "Catholic"                           0.36              0.19              0.26
 3 "Evangelical Protest…                0.35              0.22              0.28
 4 "Hindu"                              0.17              0.13              0.34
 5 "Historically Black …                0.53              0.22              0.17
 6 "Jehovah's Witness"                  0.48              0.25              0.22
 7 "Jewish"                             0.16              0.15              0.24
 8 "Mainline Protestant"                0.29              0.2               0.28
 9 "Mormon"                             0.27              0.2               0.33
10 "Muslim"                             0.34              0.17              0.29
11 "Orthodox Christian"                 0.18              0.17              0.36
12 "Unaffiliated (relig…                0.33              0.2               0.26
# ℹ 2 more variables: `$100,000 or more` &lt;dbl&gt;, n &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="tidy" class="level2">
<h2 class="anchored" data-anchor-id="tidy">Tidy ?</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 6
   religion              `Less than $30,000` `$30,000-$49,999` `$50,000-$99,999`
   &lt;chr&gt;                               &lt;dbl&gt;             &lt;dbl&gt;             &lt;dbl&gt;
 1 "Buddhist"                           0.36              0.18              0.32
 2 "Catholic"                           0.36              0.19              0.26
 3 "Evangelical Protest…                0.35              0.22              0.28
 4 "Hindu"                              0.17              0.13              0.34
 5 "Historically Black …                0.53              0.22              0.17
 6 "Jehovah's Witness"                  0.48              0.25              0.22
 7 "Jewish"                             0.16              0.15              0.24
 8 "Mainline Protestant"                0.29              0.2               0.28
 9 "Mormon"                             0.27              0.2               0.33
10 "Muslim"                             0.34              0.17              0.29
11 "Orthodox Christian"                 0.18              0.17              0.36
12 "Unaffiliated (relig…                0.33              0.2               0.26
# ℹ 2 more variables: `$100,000 or more` &lt;dbl&gt;, n &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="pivoter-les-données" class="level2">
<h2 class="anchored" data-anchor-id="pivoter-les-données">Pivoter les données</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>rel_inc <span class="sc">%&gt;%</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">religion =</span> <span class="st">`</span><span class="at">Religious tradition</span><span class="st">`</span>,</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="st">`</span><span class="at">Sample Size</span><span class="st">`</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>( </span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(religion, n),   <span class="co"># Toutes les colonnes sauf religion et n </span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"income"</span>,  </span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"proportion"</span> </span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tidy-1" class="level2">
<h2 class="anchored" data-anchor-id="tidy-1">Tidy !</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 4
   religion                   n income            proportion
   &lt;chr&gt;                  &lt;dbl&gt; &lt;chr&gt;                  &lt;dbl&gt;
 1 Buddhist                 233 Less than $30,000       0.36
 2 Buddhist                 233 $30,000-$49,999         0.18
 3 Buddhist                 233 $50,000-$99,999         0.32
 4 Buddhist                 233 $100,000 or more        0.13
 5 Catholic                6137 Less than $30,000       0.36
 6 Catholic                6137 $30,000-$49,999         0.19
 7 Catholic                6137 $50,000-$99,999         0.26
 8 Catholic                6137 $100,000 or more        0.19
 9 Evangelical Protestant  7462 Less than $30,000       0.35
10 Evangelical Protestant  7462 $30,000-$49,999         0.22
11 Evangelical Protestant  7462 $50,000-$99,999         0.28
12 Evangelical Protestant  7462 $100,000 or more        0.14
13 Hindu                    172 Less than $30,000       0.17
14 Hindu                    172 $30,000-$49,999         0.13
15 Hindu                    172 $50,000-$99,999         0.34
# ℹ 33 more rows</code></pre>
</div>
</div>
</section>
<section id="calcul-des-fréquences" class="level2">
<h2 class="anchored" data-anchor-id="calcul-des-fréquences">Calcul des fréquences</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>rel_inc <span class="sc">%&gt;%</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">religion =</span> <span class="st">`</span><span class="at">Religious tradition</span><span class="st">`</span>,</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="st">`</span><span class="at">Sample Size</span><span class="st">`</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(religion, n), </span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"income"</span>, </span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"proportion"</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">frequency =</span> <span class="fu">round</span>(proportion <span class="sc">*</span> n)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 48 × 5
   religion                   n income            proportion frequency
   &lt;chr&gt;                  &lt;dbl&gt; &lt;chr&gt;                  &lt;dbl&gt;     &lt;dbl&gt;
 1 Buddhist                 233 Less than $30,000       0.36        84
 2 Buddhist                 233 $30,000-$49,999         0.18        42
 3 Buddhist                 233 $50,000-$99,999         0.32        75
 4 Buddhist                 233 $100,000 or more        0.13        30
 5 Catholic                6137 Less than $30,000       0.36      2209
 6 Catholic                6137 $30,000-$49,999         0.19      1166
 7 Catholic                6137 $50,000-$99,999         0.26      1596
 8 Catholic                6137 $100,000 or more        0.19      1166
 9 Evangelical Protestant  7462 Less than $30,000       0.35      2612
10 Evangelical Protestant  7462 $30,000-$49,999         0.22      1642
# ℹ 38 more rows</code></pre>
</div>
</div>
</section>
<section id="enregistrer-les-données" class="level2">
<h2 class="anchored" data-anchor-id="enregistrer-les-données"><span class="heavy-red">Enregistrer</span> les données</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a>rel_inc_long <span class="ot">&lt;-</span> rel_inc <span class="sc">%&gt;%</span> </span>
<span id="cb139-2"><a href="#cb139-2"></a>  <span class="fu">rename</span>(</span>
<span id="cb139-3"><a href="#cb139-3"></a>    <span class="at">religion =</span> <span class="st">`</span><span class="at">Religious tradition</span><span class="st">`</span>,</span>
<span id="cb139-4"><a href="#cb139-4"></a>    <span class="at">n =</span> <span class="st">`</span><span class="at">Sample Size</span><span class="st">`</span></span>
<span id="cb139-5"><a href="#cb139-5"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb139-6"><a href="#cb139-6"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb139-7"><a href="#cb139-7"></a>    <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(religion, n), </span>
<span id="cb139-8"><a href="#cb139-8"></a>    <span class="at">names_to =</span> <span class="st">"income"</span>, </span>
<span id="cb139-9"><a href="#cb139-9"></a>    <span class="at">values_to =</span> <span class="st">"proportion"</span></span>
<span id="cb139-10"><a href="#cb139-10"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb139-11"><a href="#cb139-11"></a>  <span class="fu">mutate</span>(<span class="at">frequency =</span> <span class="fu">round</span>(proportion <span class="sc">*</span> n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualisation" class="level2">
<h2 class="anchored" data-anchor-id="visualisation">Visualisation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>rel_inc_long <span class="sc">%&gt;%</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> religion, <span class="at">x =</span> frequency)) <span class="sc">+</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04---data-types_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" style="width:65.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="recodage-des-religions" class="level2">
<h2 class="anchored" data-anchor-id="recodage-des-religions">Recodage des religions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>rel_inc_long <span class="ot">&lt;-</span> rel_inc_long <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">religion =</span> <span class="fu">case_when</span>(</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>    religion <span class="sc">==</span> <span class="st">"Evangelical Protestant"</span>           <span class="sc">~</span> <span class="st">"Ev. Protestant"</span>,</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>    religion <span class="sc">==</span> <span class="st">"Historically Black Protestant"</span>    <span class="sc">~</span> <span class="st">"Hist. Black Protestant"</span>,</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>    religion <span class="sc">==</span> <span class="st">'Unaffiliated (religious "nones")'</span> <span class="sc">~</span> <span class="st">"Unaffiliated"</span>,</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span>                                           <span class="sc">~</span> religion</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04---data-types_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="on-inverse-lordre" class="level2">
<h2 class="anchored" data-anchor-id="on-inverse-lordre">On inverse l’ordre</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>rel_inc_long <span class="ot">&lt;-</span> rel_inc_long <span class="sc">%&gt;%</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">religion =</span> <span class="fu">fct_rev</span>(religion)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04---data-types_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="on-nettoie-tout-ça" class="level2">
<h2 class="anchored" data-anchor-id="on-nettoie-tout-ça">On nettoie tout ça</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rel_inc_long, <span class="fu">aes</span>(<span class="at">y =</span> religion, <span class="at">x =</span> frequency, <span class="at">fill =</span> income)) <span class="sc">+</span> </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span>                         <span class="co"># On veut des barres pleines pour les proportions</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>() <span class="sc">+</span>                              <span class="co"># On change les couleurs</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>                                     <span class="co"># On change le thème</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span>                   <span class="co"># On met la légende en bas</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span> <span class="co"># On met la légende sur 2 lignes</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(                                                 <span class="co"># On met à jour les labels</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Proportion"</span>, <span class="at">y =</span> <span class="st">""</span>, </span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Income distribution by religious group"</span>, </span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Source: Pew Research Center, Religious Landscape Study"</span>, </span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Income"</span> </span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tada" class="level2">
<h2 class="anchored" data-anchor-id="tada">TADA ?</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04---data-types_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="on-veut-les-revenu-dans-le-bon-ordre" class="level2">
<h2 class="anchored" data-anchor-id="on-veut-les-revenu-dans-le-bon-ordre">On veut les revenu dans le bon ordre !</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>rel_inc_long <span class="ot">&lt;-</span> rel_inc_long <span class="sc">%&gt;%</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">income =</span> <span class="fu">fct_relevel</span>(income, <span class="st">"$100,000 or more"</span>, <span class="st">"$50,000-$99,999"</span>, <span class="st">"$30,000-$49,999"</span>, <span class="st">"Less than $30,000"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tada-1" class="level2">
<h2 class="anchored" data-anchor-id="tada-1">TADA !</h2>
<div class="cell">
<div class="cell-output-display">
<div id="fig-final-final" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-final-final-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="04---data-types_files/figure-html/fig-final-final-1.png" id="fig-final-final" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-final-final-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="références" class="level2">
<h2 class="anchored" data-anchor-id="références">Références</h2>
<div id="refs" role="list">

</div>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>